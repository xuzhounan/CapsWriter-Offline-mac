# 📋 任务执行和文档记录标准模板

## 🎯 快速启动 Prompt (复制使用)

```
请你协助开发 CapsWriter-mac 项目。

项目路径: /Users/xzn/Desktop/code-project/CapsWriter-Offline-mac

请先执行以下步骤:
1. 阅读 ./CLAUDE.md 文件了解项目背景和架构
2. 查看 ./PROJECT_CONTEXT_PROMPT.md 了解开发规范  
3. 检查当前 Git 状态: git status && git log --oneline -5
4. 了解项目当前的开发阶段和待执行任务

完成上下文载入后，我将为你分配具体的开发任务。

请按照文档中的规范执行任务，并保持文档同步更新。
```

## 📝 任务执行标准流程

### 阶段一：任务接收和规划

**1. 上下文确认**
```
✅ 项目上下文已载入
当前处于: [第X阶段 - 阶段名称]  
准备执行: [具体任务描述]
预期交付: [交付物清单]
```

**2. 任务分解 (使用 TodoWrite)**
```python
# 示例任务分解
TodoWrite([
    {"id": "1", "content": "分析当前代码结构", "status": "pending", "priority": "high"},
    {"id": "2", "content": "设计新模块架构", "status": "pending", "priority": "high"},  
    {"id": "3", "content": "实现核心功能", "status": "pending", "priority": "medium"},
    {"id": "4", "content": "编写单元测试", "status": "pending", "priority": "medium"},
    {"id": "5", "content": "更新文档", "status": "pending", "priority": "low"}
])
```

### 阶段二：任务执行

**3. 执行前检查**
- [ ] 确认依赖文件存在
- [ ] 备份关键代码 (如需要)
- [ ] 理解现有架构和约束
- [ ] 标记当前任务为 `in_progress`

**4. 开发过程**
```bash
# 示例开发流程
# 1. 创建新文件/修改现有文件
# 2. 遵循 Swift API Design Guidelines
# 3. 确保编译通过
# 4. 验证功能正确性
# 5. 更新任务状态为 completed
```

### 阶段三：质量检查

**5. 代码验证**
```bash
# macOS 项目编译检查
cd CapsWriter-mac
xcodebuild -project CapsWriter-mac.xcodeproj -scheme CapsWriter-mac build

# 代码格式检查 (如有 SwiftLint)
swiftlint lint

# 权限配置检查
plutil -p Info.plist | grep -i usage
```

**6. 功能测试**
- [ ] 核心功能正常运行
- [ ] 权限申请流程正确
- [ ] 无明显性能问题
- [ ] 错误处理机制完善

### 阶段四：文档和提交

**7. 文档更新**
根据变更类型更新对应文档：

```bash
# API 变更 → 更新 CLAUDE.md 中的接口说明
# 新功能 → 更新功能描述和使用说明  
# 架构变更 → 更新架构设计章节
# 配置变更 → 更新配置说明
```

**8. Git 提交标准**
```bash
# 添加修改的文件
git add [文件列表]

# 标准提交格式
git commit -m "$(cat <<'EOF'
<type>(<scope>): <简洁描述>

<详细说明 (可选)>
- 变更点1
- 变更点2

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"
```

**提交类型参考**:
- `feat(core)`: 新增核心功能
- `fix(ui)`: 修复界面问题  
- `refactor(service)`: 重构服务层
- `docs(api)`: 更新API文档
- `test(unit)`: 添加单元测试
- `chore(build)`: 构建相关修改

### 阶段五：任务总结

**9. 完成确认**
```
✅ 任务执行完成

📋 完成内容:
- [交付物1]: 功能描述 + 文件路径  
- [交付物2]: 功能描述 + 文件路径
- [文档更新]: 更新内容概述

🔍 验证结果:
- [ ] 编译通过
- [ ] 功能正常  
- [ ] 文档同步
- [ ] Git 提交完成

📊 任务统计:
- 新增文件: X 个
- 修改文件: Y 个  
- 代码行数: +A/-B
- 测试覆盖: Z%
```

**10. 后续建议**
```
💡 下一步建议:
1. [相关任务1] - 优先级: 高/中/低
2. [相关任务2] - 优先级: 高/中/低  
3. [优化建议] - 长期规划

⚠️ 注意事项:
- [需要关注的问题]
- [潜在的技术债务]
- [性能优化点]
```

## 🚀 常用任务模板

### 模板 1: 新功能开发
```
任务: 实现 [功能名称]

要求:
1. 按照 CLAUDE.md 中第X阶段的设计要求
2. 创建文件: [具体文件路径]  
3. 实现功能: [核心功能描述]
4. 集成测试: [测试要求]
5. 文档更新: [需要更新的文档]

验收标准:
- [ ] 功能正常运行
- [ ] 代码符合规范
- [ ] 文档同步更新
- [ ] Git 提交规范
```

### 模板 2: Bug 修复
```
任务: 修复 [问题描述]

问题现状:
- 问题表现: [具体症状]
- 影响范围: [影响的功能模块]  
- 重现步骤: [如何重现]

解决方案:
1. 问题定位: [分析思路]
2. 修复策略: [解决方案]
3. 测试验证: [验证方法]
4. 回归防护: [防止再次出现的措施]

验收标准:
- [ ] 问题完全解决
- [ ] 不引入新问题  
- [ ] 相关测试通过
```

### 模板 3: 重构任务  
```
任务: 重构 [模块名称]

重构目标:
- 代码质量: [提升的质量指标]
- 性能优化: [性能改进目标]
- 可维护性: [架构改进点]

实施计划:
1. 现状分析: [当前问题分析]
2. 设计新架构: [新架构设计]  
3. 分步迁移: [迁移策略]
4. 验证测试: [验证方案]

验收标准:
- [ ] 功能保持不变
- [ ] 代码质量提升
- [ ] 性能指标改善
- [ ] 文档完整更新
```

## 📊 文档记录检查清单

**每次任务完成后，请检查以下文档是否需要更新**:

### 必检文档
- [ ] **CLAUDE.md** - 项目主文档
  - 架构设计变更
  - 开发命令更新  
  - 常见问题补充

- [ ] **README.md** - 用户文档 (如存在)
  - 功能说明更新
  - 安装使用指南
  - 更新日志

### 可选文档  
- [ ] **API 文档** - 接口变更时
- [ ] **架构图** - 重大架构调整时
- [ ] **配置说明** - 新增配置项时
- [ ] **故障排除** - 新发现问题时

### 代码注释
- [ ] **类/结构体注释** - 新增主要组件时
- [ ] **方法注释** - 复杂逻辑实现时  
- [ ] **配置注释** - 重要配置说明时

---

## 🎯 使用说明

1. **新对话开始时**: 使用"快速启动 Prompt"
2. **任务执行中**: 按照"标准流程"逐步进行
3. **任务类型选择**: 根据实际需求选择对应模板
4. **文档维护**: 使用检查清单确保文档同步

这套模板确保每次任务执行的一致性和完整性，帮助维护高质量的项目文档和代码。